# Lecture 14

## Z逆变换

核心在于利用：

\[ \mathbf{Z}[a^nu(n)] = \frac{1}{1-az^{-1}} \]

我们将\(X(z)\)拆分成若干个\(\frac{1}{1-az^{-1}}\)的线性组合，即可通过Z变换的线性性质得出逆变换的结果。

------

对于Z变换\(X(z) = \frac{N(z)}{D(z)}\)，若分子分母都为多项式函数，且分子的次数小于分母，那我们一定可以作一下分解：

\[ \begin{align}
X(z) = \frac{N(z)}{D(z)} &= \frac{N(z)}{(1-p_1z^{-1})(1-p_2z^{-1})\cdots (1-p_Mz^{-1})} \\
&= \frac{A_1}{1-p_1z^{-1}}+\frac{A_2}{1-p_2z^{-1}}+\cdots +\frac{A_M}{1-p_Mz^{-1}}
\end{align} \]

其中各个\(A_i\)可以通过下式求得：

\[ A_i = [(1-p_iz^{-1})X(z)]_{z=p_i} \]

那么Z逆变换则为：

\[ x(n) = A_1p_1^nu(n)+A_2p_2^nu(n)+\cdots +A_Mp_M^nu(n) \]

------

若分子次数大于等于分母次数，我们有两种方法。第一种是先计算\(W(z)=\frac{1}{D(z)}\)的逆变换，然后再计算\(X(z)=N(z)/D(z)=N(z)W(z)\)的逆变换。\(W(z)\)的求法同上，记其逆变换为\(w(n)\)。\(N(z)\)为多项式函数，因此可以写为：

\[ X(z) = (A_0+A_1z^{-1}+\cdots +A_Mz^{-M})W(z) = A_0W(z)+A_1z^{-1}W(z)+\cdots +A_Mz^{-M}W(z) \]

根据时移特性，我们有：

\[ \mathbf{Z}[x(n-m)] = z^{-m}X(z) \]

原式的逆变换为：

\[ x(n) = A_0w(n)+A_1w(n-1)+\cdots +A_Mw(n-M) \]

------

我们也可以直接做多项次除法，将\(X(z)\)分解为：

\[ X(z) = \sum_{i=0}^MA_iz^{-i}+\sum_{j=1}^N\frac{B_j}{1-p_jz^{-j}} \]

根据时移特性和\(\mathbf{Z}[\delta(n)]=1\)，我们有：

\[ \mathbf{Z}[\delta(n-m)]=z^{-m} \]

因此原式逆变换为：

\[ x(n) = \sum_{i=0}^MA_i\delta(n-i)+\sum_{j=1}^NB_jp_j^nu(n) \]

------

求逆变换时需要特别注意收敛域，因为某些不同序列Z变换的形式是相同的，如：

\[ \begin{align}
a^nu(n) &\leftrightarrow \frac{1}{1-az^{-1}}\quad |z| > |a| \\
-a^nu(-n-1) &\leftrightarrow \begin{cases} \frac{1}{1-az^{-1}} & |z| < |a| \\ 0 & z=0\end{cases}
\end{align} \]

------

可以直接利用Z逆变换的定义和留数定理求解Z逆变换：

\[ x(n) = \frac{1}{2\pi j}\oint_CX(z)z^{n-1}dz = \sum \mathrm{Res}[X(z)z^{n-1}]_{z=p_m} \]

其中，曲线\(C\)为完全位于收敛域内包含原点的逆时针闭合路径，\(p_m\)为\(C\)包围的\(X(z)z^{n-1}\)的极点。

??? "留数的计算方法"

    **一阶极点**

    \[ \mathrm{Res}(f,c) = \lim_{z\rightarrow c}(z-c)f(z) \]

    若\(f(z)=\frac{g(z)}{h(z)}\)，且\(g(c)\neq 0,h(c)=0\)，那么留数为：

    \[ \mathrm{Res}(f,c) = \frac{g(c)}{h'(c)} \]

    **高阶极点**

    \[ \mathrm{Res}(f,c) = \frac{1}{(n-1)!}\lim_{z\rightarrow c}\frac{d^{n-1}}{dz^{n-1}}((z-c)^nf(z)) \]

------

也可以暴力利用多项式除法直接将\(X(z)\)按照\(z^{-1}\)展开为幂级数，然后其逆变换易得。

如：

\[ X(z)=\frac{z^2+z}{z^3-3z^3+3z-1}\quad |z| > 1 \]

可以直接展开为：

\[ X(z) = \sum_{n=0}^{\infty}n^2z^{-n} \]

根据收敛域判断其为因果序列，因此原序列为：

\[ x(n) = n^2u(n) \]

## Z变换的应用

### 传递函数

离散时间LTI系统的输出与单位脉冲响应有以下关系：

\[ y(n) = x(n)\ast h(n) \]

求Z变换得：

\[ Y(z) = X(z)\cdot H(z) \Rightarrow H(z) = \frac{Y(z)}{X(z)} \]

我们称\(H(z)\)为LTI系统的**传递函数**，或**系统函数**。

- 并联系统的传递函数是子系统传递函数之和
- 串联系统的传递函数是子系统传递函数之积

可以通过传递函数求出传递函数：

\[ \sum_{k=0}^{N}b_ky(n-k)=\sum_{r=0}^{M}a_rx(n-r) \Rightarrow H(z) = \frac{\sum_{r=0}^Ma_rz^{-r}}{\sum_{k=0}^Nb_kz^{-k}} \]

### 稳定性与因果性

- 离散线性时不变系统是**因果系统**的充要条件是：传递函数的ROC为某个圆外部的区域，包括无限远点。
- 离散线性时不变系统是**稳定系统**的充要条件是：传递函数的ROC包括单位圆。

### 频率响应的几何作图

\[ H(z)=\frac{Y(z)}{X(z)}=G\frac{\prod_{r=1}^R(z-z_r)}{\prod_{k=1}^K(z-p_k)}
\Rightarrow G\frac{\prod_{r=1}^R(e^{j\omega}-z_r)}{\prod_{k=1}^K(e^{j\omega}-p_k)} \]

称\(e^{j\omega}-z_r=A_re^{j\varphi_r}\)为零点向量差，\(e^{j\omega}-p_k=B_ke^{j\theta_k}\)为极点向量差，那么整体的频率响应的模长和相位可以通过这一系列向量差求得：

\[ H(\omega) = \left(G\frac{\prod_{r=1}^RA_r}{\prod_{k=1}^KB_k}\right)\mathrm{exp}[j(\sum_{r=1}^R\varphi_r-\sum_{k=1}^K\theta_k)] \]

在复平面上标出各个零点与极点，分别绘制它们到单位圆上的点的向量差，即可得到脉冲响应。

## FIR滤波器设计

### 低通滤波器的窗函数设计法

1. 在过渡带宽度（通带边缘频率到阻带边缘频率）中间，选择理想低通滤波器的截止频率\(f_c\)
2. 计算截止频率的数字频率\(\Omega_c=2\pi\frac{f_c}{f_s}\)，并代入理想低通滤波器的时域函数\(h(n)=\frac{\sin(n\Omega_c)}{n\pi}\)
3. 查表，选择符合阻带衰减与其他要求的窗函数，并计算窗函数内非零项的数目，选择奇数项，代入计算窗函数
4. 将窗函数与\(h(n)\)相乘，计算有限长脉冲响应
5. 将脉冲响应右移\(\frac{N-1}{2}\)，使第一个非零值在\(n=0\)处

常用的窗函数有：矩形窗、汉宁窗、哈明窗、布莱克曼窗、凯塞窗。

### 高通、带通、带阻滤波器的设计方法

我们可以通过乘上余弦函数来进行频移：

\[ h'(n) = h(n)w(n)\cos(n\Omega_0) \]

带通、高通滤波器都可以通过低通滤波器直接频移实现，注意脉冲响应本质上是中心对称的，低通滤波器只使用了右半部分。带通滤波器也可以看做是低通和高通滤波器的并联，带阻滤波器可以看做是低通和高通滤波器的串联。

## IIR滤波器设计

### 设计步骤

1. 根据性能要求，设计相应的低通**模拟**滤波器：
      1. 常用的类型有：巴特沃斯滤波器、切比雪夫I/II型滤波器、椭圆滤波器
2. 通过双线性变换，得到相应的低通**数字**滤波器
3. 求其Z逆变换

### 双线性变换

\[ s \Leftrightarrow 2f_s\frac{z-1}{z+1} \]

将上式代入模拟滤波器传递函数\(H(s)=H(j\omega)\)中，即可得到数字滤波器的传递函数\(H(z)\)。

将\(z=e^{j\Omega}\)代入化简，得到双线性变换过程中模拟频率和数字频率之间的关系，也称为**预扭曲方程**：

\[ \frac{\omega}{f_s} = 2\tan(\frac{\Omega}{2}) \]

### 巴特沃斯滤波器设计

1. 求滤波器的通带边缘频率\(f_{p1}\)、阻带边缘频率\(f_{s1}\)、阻带衰减参数
2. 求上面两个边缘频率对应的数字频率\(\Omega_{p1}, \Omega_{s1}\)
3. 用**预扭曲方程**再求数字频率对应的模拟频率\(\omega_{p1}, \omega_{s1}\)
4. 用给定的阻带衰减参数确定阻带边缘增益\(\delta_s\)
5. 计算模拟滤波器的阶数
      1. \[n\geqslant \frac{\log(\frac{1}{\delta_s^2-1})}{2\log(\frac{\omega_{s1}}{\omega_{p1}})},\quad n\in \mathbb{N}\]
6. 查表得模拟滤波器的传递函数，通过双线性变换球得数字滤波器的传递函数

